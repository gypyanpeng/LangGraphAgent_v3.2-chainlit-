# LangGraph æ™ºèƒ½ä½“ç³»ç»Ÿæ··åˆæ¨¡å¼æ¶æ„è®¾è®¡æ–¹æ¡ˆ

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–¹æ¡ˆè®¾è®¡äº†ä¸€ä¸ªæ··åˆæ¨¡å¼æ¶æ„ï¼Œæ—¢ä¿æŒç°æœ‰çš„å‘½ä»¤è¡Œç‰ˆæœ¬ï¼Œåˆæ·»åŠ å¯é€‰çš„Web APIæ¨¡å¼ï¼Œå…±äº«æ ¸å¿ƒæ™ºèƒ½ä½“é€»è¾‘ï¼Œæ”¯æŒçµæ´»çš„éƒ¨ç½²é€‰æ‹©ã€‚

## ğŸ¯ è®¾è®¡ç›®æ ‡

1. **ä¿æŒå…¼å®¹æ€§**ï¼šç°æœ‰å‘½ä»¤è¡Œç‰ˆæœ¬å®Œå…¨ä¸å˜
2. **å…±äº«æ ¸å¿ƒé€»è¾‘**ï¼šæ™ºèƒ½ä½“ã€å·¥å…·ã€æŒä¹…åŒ–é€»è¾‘å¤ç”¨
3. **çµæ´»éƒ¨ç½²**ï¼šå¯é€‰æ‹©å‘½ä»¤è¡Œæ¨¡å¼ã€Web APIæ¨¡å¼æˆ–æ··åˆæ¨¡å¼
4. **æ¸è¿›å‡çº§**ï¼šå¯ä»¥é€æ­¥ä»å‘½ä»¤è¡Œè¿ç§»åˆ°Web API
5. **ç»Ÿä¸€ç®¡ç†**ï¼šå…±äº«é…ç½®ã€æ•°æ®åº“å’Œä¼šè¯ç®¡ç†

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·æ¥å£å±‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å‘½ä»¤è¡Œç•Œé¢ (CLI)   â”‚        Web API ç•Œé¢                   â”‚
â”‚   - main.py         â”‚   - FastAPI æœåŠ¡å™¨                    â”‚
â”‚   - äº¤äº’å¼å¯¹è¯       â”‚   - RESTful API                      â”‚
â”‚   - å‘½ä»¤è¡Œå·¥å…·       â”‚   - WebSocket å®æ—¶é€šä¿¡                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æœåŠ¡æŠ½è±¡å±‚                                â”‚
â”‚   - AgentService (æ ¸å¿ƒæ™ºèƒ½ä½“æœåŠ¡)                           â”‚
â”‚   - SessionService (ä¼šè¯ç®¡ç†æœåŠ¡)                           â”‚
â”‚   - ToolService (å·¥å…·ç®¡ç†æœåŠ¡)                              â”‚
â”‚   - ConfigService (é…ç½®ç®¡ç†æœåŠ¡)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ ¸å¿ƒä¸šåŠ¡å±‚                                â”‚
â”‚   - LangGraph æ™ºèƒ½ä½“ (ç°æœ‰é€»è¾‘)                             â”‚
â”‚   - MCP å·¥å…·ç³»ç»Ÿ (ç°æœ‰é€»è¾‘)                                 â”‚
â”‚   - æŒä¹…åŒ–ç³»ç»Ÿ (ç°æœ‰é€»è¾‘)                                   â”‚
â”‚   - ä¼šè¯ç®¡ç† (ç°æœ‰é€»è¾‘)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ•°æ®å­˜å‚¨å±‚                                â”‚
â”‚   - SQLite æ•°æ®åº“ (å…±äº«)                                    â”‚
â”‚   - é…ç½®æ–‡ä»¶ (å…±äº«)                                         â”‚
â”‚   - æ—¥å¿—ç³»ç»Ÿ (å…±äº«)                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ–°çš„é¡¹ç›®ç»“æ„
```
my_project/
â”œâ”€â”€ main.py                    # ç°æœ‰å‘½ä»¤è¡Œå…¥å£ (ä¿æŒä¸å˜)
â”œâ”€â”€ web_main.py                # æ–°å¢ï¼šWeb API å…¥å£
â”œâ”€â”€ hybrid_main.py             # æ–°å¢ï¼šæ··åˆæ¨¡å¼å…¥å£
â”œâ”€â”€ 
â”œâ”€â”€ core/                      # æ–°å¢ï¼šæ ¸å¿ƒä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agent_core.py          # ä» main.py æå–çš„æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ session_manager.py     # å¢å¼ºçš„ä¼šè¯ç®¡ç†
â”‚   â”œâ”€â”€ config_manager.py      # ç»Ÿä¸€é…ç½®ç®¡ç†
â”‚   â””â”€â”€ persistence.py         # æŒä¹…åŒ–æŠ½è±¡å±‚
â”œâ”€â”€ 
â”œâ”€â”€ services/                  # æ–°å¢ï¼šæœåŠ¡æŠ½è±¡å±‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agent_service.py       # æ™ºèƒ½ä½“æœåŠ¡
â”‚   â”œâ”€â”€ session_service.py     # ä¼šè¯æœåŠ¡
â”‚   â”œâ”€â”€ tool_service.py        # å·¥å…·æœåŠ¡
â”‚   â””â”€â”€ auth_service.py        # è®¤è¯æœåŠ¡ (Web API ç”¨)
â”œâ”€â”€ 
â”œâ”€â”€ interfaces/                # æ–°å¢ï¼šæ¥å£å±‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ cli/                   # å‘½ä»¤è¡Œæ¥å£
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ cli_handler.py     # ä» main.py æå–çš„ CLI é€»è¾‘
â”‚   â””â”€â”€ web/                   # Web API æ¥å£
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ api/               # API è·¯ç”±
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ auth.py
â”‚       â”‚   â”œâ”€â”€ sessions.py
â”‚       â”‚   â”œâ”€â”€ messages.py
â”‚       â”‚   â””â”€â”€ system.py
â”‚       â”œâ”€â”€ websocket/         # WebSocket å¤„ç†
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â””â”€â”€ chat_handler.py
â”‚       â””â”€â”€ middleware/        # ä¸­é—´ä»¶
â”‚           â”œâ”€â”€ __init__.py
â”‚           â”œâ”€â”€ auth.py
â”‚           â””â”€â”€ cors.py
â”œâ”€â”€ 
â”œâ”€â”€ config/                    # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ app_config.json        # æ–°å¢ï¼šåº”ç”¨é…ç½®
â”‚   â”œâ”€â”€ llm_config.json        # ç°æœ‰ï¼šLLM é…ç½®
â”‚   â”œâ”€â”€ mcp_config.json        # ç°æœ‰ï¼šMCP é…ç½®
â”‚   â””â”€â”€ persistence_config.json # ç°æœ‰ï¼šæŒä¹…åŒ–é…ç½®
â”œâ”€â”€ 
â”œâ”€â”€ llm_loader.py              # ç°æœ‰æ–‡ä»¶ (ä¿æŒä¸å˜)
â”œâ”€â”€ mcp_loader.py              # ç°æœ‰æ–‡ä»¶ (ä¿æŒä¸å˜)
â”œâ”€â”€ data/                      # ç°æœ‰æ•°æ®ç›®å½• (å…±äº«)
â”œâ”€â”€ docs/                      # ç°æœ‰æ–‡æ¡£ç›®å½•
â””â”€â”€ tests/                     # ç°æœ‰æµ‹è¯•ç›®å½•
```

## ğŸ”§ æ ¸å¿ƒç»„ä»¶è®¾è®¡

### 1. åº”ç”¨é…ç½® (config/app_config.json)
```json
{
  "app": {
    "name": "LangGraphæ™ºèƒ½ä½“ç³»ç»Ÿ",
    "version": "2.0.0",
    "mode": "hybrid"
  },
  "interfaces": {
    "cli": {
      "enabled": true,
      "default_user": "cli_user"
    },
    "web": {
      "enabled": true,
      "host": "0.0.0.0",
      "port": 8000,
      "cors_origins": ["http://localhost:3000"],
      "auth_required": false
    }
  },
  "features": {
    "multi_agent": {
      "enabled": false,
      "supervisor_mode": true
    },
    "real_time_streaming": true,
    "session_isolation": true
  }
}
```

### 2. æ ¸å¿ƒæ™ºèƒ½ä½“æœåŠ¡ (core/agent_core.py)
```python
# core/agent_core.py
"""
æ ¸å¿ƒæ™ºèƒ½ä½“é€»è¾‘ - ä» main.py æå–å¹¶å¢å¼º
"""

import asyncio
from typing import Dict, Any, Optional, AsyncGenerator
from langchain_core.messages import HumanMessage, AIMessage, ToolMessage
from langgraph.graph import END, StateGraph, MessagesState
from langgraph.prebuilt import ToolNode

from llm_loader import load_llm_from_config
from mcp_loader import load_mcp_tools_from_config
from .persistence import create_checkpointer
from .config_manager import ConfigManager

class AgentCore:
    """æ ¸å¿ƒæ™ºèƒ½ä½“ç±» - å¯è¢«CLIå’ŒWeb APIå…±äº«ä½¿ç”¨"""
    
    def __init__(self, config_manager: ConfigManager):
        self.config_manager = config_manager
        self.app = None
        self.tools = None
        self.checkpointer = None
        self._initialized = False
    
    async def initialize(self):
        """åˆå§‹åŒ–æ™ºèƒ½ä½“"""
        if self._initialized:
            return
        
        print("--- åˆå§‹åŒ–æ™ºèƒ½ä½“æ ¸å¿ƒ ---")
        
        # åˆ›å»ºæ£€æŸ¥ç‚¹å­˜å‚¨å™¨
        self.checkpointer = await create_checkpointer(
            self.config_manager.get_persistence_config()
        )
        
        # åŠ è½½LLMå’Œå·¥å…·
        llm = load_llm_from_config("config/llm_config.json")
        _, self.tools = await load_mcp_tools_from_config("config/mcp_config.json")
        
        # æ„å»ºå·¥ä½œæµ
        self.app = await self._build_workflow(llm, self.tools)
        self._initialized = True
        
        print("--- æ™ºèƒ½ä½“æ ¸å¿ƒåˆå§‹åŒ–å®Œæˆ ---")
    
    async def _build_workflow(self, llm, tools):
        """æ„å»ºLangGraphå·¥ä½œæµ - ä¸åŸmain.pyé€»è¾‘ç›¸åŒ"""
        llm_with_tools = llm.bind_tools(tools)
        
        def call_model(state: MessagesState):
            messages = state["messages"]
            try:
                response = llm_with_tools.invoke(messages)
                if not response.content and not (hasattr(response, 'tool_calls') and response.tool_calls):
                    response = AIMessage(content="æŠ±æ­‰ï¼Œæˆ‘æ— æ³•å¤„ç†è¿™ä¸ªè¯·æ±‚ã€‚è¯·é‡æ–°å°è¯•ã€‚")
                return {"messages": [response]}
            except Exception as e:
                error_response = AIMessage(content=f"æŠ±æ­‰ï¼Œå¤„ç†è¯·æ±‚æ—¶å‡ºç°é”™è¯¯: {str(e)}")
                return {"messages": [error_response]}
        
        tool_node = ToolNode(tools)
        
        def should_continue(state: MessagesState):
            messages = state["messages"]
            last_message = messages[-1]
            if isinstance(last_message, AIMessage) and hasattr(last_message, 'tool_calls') and last_message.tool_calls:
                return "tools"
            return END
        
        # æ„å»ºå›¾
        workflow = StateGraph(MessagesState)
        workflow.add_node("agent", call_model)
        workflow.add_node("tools", tool_node)
        workflow.set_entry_point("agent")
        workflow.add_conditional_edges("agent", should_continue, ["tools", END])
        workflow.add_edge("tools", "agent")
        
        return workflow.compile(checkpointer=self.checkpointer)
    
    async def process_message(
        self, 
        message: str, 
        session_config: Dict[str, Any],
        stream: bool = True
    ) -> AsyncGenerator[Dict[str, Any], None]:
        """å¤„ç†æ¶ˆæ¯ - æ”¯æŒæµå¼å’Œéæµå¼"""
        if not self._initialized:
            await self.initialize()
        
        inputs = {"messages": [HumanMessage(content=message)]}
        
        if stream:
            async for output in self.app.astream(inputs, config=session_config, stream_mode="values"):
                yield {
                    "type": "stream_chunk",
                    "data": output,
                    "session_id": session_config["configurable"]["thread_id"]
                }
        else:
            result = await self.app.ainvoke(inputs, config=session_config)
            yield {
                "type": "final_result",
                "data": result,
                "session_id": session_config["configurable"]["thread_id"]
            }
    
    async def get_session_history(self, session_config: Dict[str, Any]) -> Dict[str, Any]:
        """è·å–ä¼šè¯å†å²"""
        if not self._initialized:
            await self.initialize()
        
        try:
            state = await self.app.aget_state(session_config)
            if state.values and "messages" in state.values:
                return {
                    "success": True,
                    "messages": state.values["messages"],
                    "session_id": session_config["configurable"]["thread_id"]
                }
            else:
                return {
                    "success": True,
                    "messages": [],
                    "session_id": session_config["configurable"]["thread_id"]
                }
        except Exception as e:
            return {
                "success": False,
                "error": str(e),
                "session_id": session_config["configurable"]["thread_id"]
            }
    
    def get_available_tools(self):
        """è·å–å¯ç”¨å·¥å…·åˆ—è¡¨"""
        if not self.tools:
            return []
        
        return [
            {
                "name": tool.name,
                "description": tool.description,
                "parameters": getattr(tool, 'args_schema', None)
            }
            for tool in self.tools
        ]
```

### 3. å¢å¼ºçš„ä¼šè¯ç®¡ç† (core/session_manager.py)
```python
# core/session_manager.py
"""
å¢å¼ºçš„ä¼šè¯ç®¡ç†å™¨ - æ”¯æŒCLIå’ŒWeb API
"""

import uuid
import time
from typing import Dict, Any, Optional, List
from dataclasses import dataclass
from datetime import datetime, timedelta

@dataclass
class SessionInfo:
    """ä¼šè¯ä¿¡æ¯"""
    thread_id: str
    user_id: str
    created_at: datetime
    last_activity: datetime
    title: str = ""
    mode: str = "single_agent"
    status: str = "active"

class EnhancedSessionManager:
    """å¢å¼ºçš„ä¼šè¯ç®¡ç†å™¨"""
    
    def __init__(self, config: Optional[Dict[str, Any]] = None):
        self.config = config or {}
        session_config = self.config.get("session_management", {})
        
        self.sessions: Dict[str, SessionInfo] = {}
        self.default_user_id = session_config.get("default_user_prefix", "default_user")
        self.session_timeout_hours = session_config.get("session_timeout_hours", 24)
        self.max_sessions_per_user = session_config.get("max_sessions_per_user", 10)
        self.auto_cleanup_enabled = session_config.get("auto_cleanup_enabled", True)
    
    def create_session(
        self, 
        user_id: Optional[str] = None, 
        title: str = "",
        mode: str = "single_agent"
    ) -> str:
        """åˆ›å»ºæ–°ä¼šè¯"""
        if user_id is None:
            user_id = self.default_user_id
        
        thread_id = f"{user_id}_{uuid.uuid4().hex[:8]}"
        now = datetime.now()
        
        session_info = SessionInfo(
            thread_id=thread_id,
            user_id=user_id,
            created_at=now,
            last_activity=now,
            title=title or f"ä¼šè¯ {now.strftime('%m-%d %H:%M')}",
            mode=mode,
            status="active"
        )
        
        self.sessions[thread_id] = session_info
        self._cleanup_old_sessions(user_id)
        
        return thread_id
    
    def get_session_config(self, thread_id: str, user_id: Optional[str] = None) -> Dict[str, Any]:
        """è·å–LangGraphæ ‡å‡†çš„ä¼šè¯é…ç½®"""
        # æ›´æ–°æœ€åæ´»åŠ¨æ—¶é—´
        if thread_id in self.sessions:
            self.sessions[thread_id].last_activity = datetime.now()
        
        config = {"configurable": {"thread_id": thread_id}}
        
        if user_id:
            config["configurable"]["user_id"] = user_id
        elif thread_id in self.sessions:
            config["configurable"]["user_id"] = self.sessions[thread_id].user_id
        
        return config
    
    def get_user_sessions(self, user_id: str) -> List[SessionInfo]:
        """è·å–ç”¨æˆ·çš„æ‰€æœ‰ä¼šè¯"""
        return [
            session for session in self.sessions.values()
            if session.user_id == user_id and session.status == "active"
        ]
    
    def get_session_info(self, thread_id: str) -> Optional[SessionInfo]:
        """è·å–ä¼šè¯ä¿¡æ¯"""
        return self.sessions.get(thread_id)
    
    def update_session_title(self, thread_id: str, title: str) -> bool:
        """æ›´æ–°ä¼šè¯æ ‡é¢˜"""
        if thread_id in self.sessions:
            self.sessions[thread_id].title = title
            return True
        return False
    
    def delete_session(self, thread_id: str) -> bool:
        """åˆ é™¤ä¼šè¯"""
        if thread_id in self.sessions:
            self.sessions[thread_id].status = "deleted"
            return True
        return False
    
    def _cleanup_old_sessions(self, user_id: str):
        """æ¸…ç†æ—§ä¼šè¯"""
        if not self.auto_cleanup_enabled:
            return
        
        user_sessions = self.get_user_sessions(user_id)
        
        # æŒ‰åˆ›å»ºæ—¶é—´æ’åºï¼Œä¿ç•™æœ€æ–°çš„ä¼šè¯
        user_sessions.sort(key=lambda x: x.created_at, reverse=True)
        
        # åˆ é™¤è¶…å‡ºé™åˆ¶çš„ä¼šè¯
        if len(user_sessions) > self.max_sessions_per_user:
            for session in user_sessions[self.max_sessions_per_user:]:
                session.status = "archived"
        
        # åˆ é™¤è¶…æ—¶çš„ä¼šè¯
        timeout_threshold = datetime.now() - timedelta(hours=self.session_timeout_hours)
        for session in user_sessions:
            if session.last_activity < timeout_threshold:
                session.status = "expired"
```

## ğŸš€ å¯åŠ¨æ¨¡å¼

### 1. å‘½ä»¤è¡Œæ¨¡å¼ (ä¿æŒç°æœ‰)
```bash
# ä½¿ç”¨ç°æœ‰çš„ main.py
uv run python main.py
```

### 2. Web API æ¨¡å¼
```bash
# ä½¿ç”¨æ–°çš„ web_main.py
uv run python web_main.py
```

### 3. æ··åˆæ¨¡å¼
```bash
# ä½¿ç”¨æ–°çš„ hybrid_main.pyï¼ŒåŒæ—¶å¯åŠ¨CLIå’ŒWeb API
uv run python hybrid_main.py
```

## ğŸ“ˆ å®æ–½è®¡åˆ’

### Phase 1: æ ¸å¿ƒé‡æ„ (ç¬¬1å‘¨)
- [ ] æå–æ ¸å¿ƒé€»è¾‘åˆ° `core/` ç›®å½•
- [ ] åˆ›å»ºç»Ÿä¸€é…ç½®ç®¡ç†å™¨
- [ ] åˆ›å»ºæœåŠ¡æŠ½è±¡å±‚
- [ ] é‡æ„ç°æœ‰ `main.py` ä½¿ç”¨æ–°æ¶æ„
- [ ] ç¡®ä¿å‘åå…¼å®¹æ€§
- [ ] æ·»åŠ åŸºç¡€é”™è¯¯å¤„ç†æœºåˆ¶

### Phase 2: Web API å®ç° (ç¬¬2-3å‘¨)
- [ ] æ›´æ–°é¡¹ç›®ä¾èµ–ï¼ˆFastAPIç­‰ï¼‰
- [ ] å®ç° FastAPI æœåŠ¡å™¨
- [ ] åˆ›å»º RESTful API æ¥å£
- [ ] å®ç° WebSocket å®æ—¶é€šä¿¡
- [ ] æ·»åŠ å…¨å±€å¼‚å¸¸å¤„ç†
- [ ] å®ç°åŸºç¡€è®¤è¯ç³»ç»Ÿ

### Phase 3: æ··åˆæ¨¡å¼å’Œæµ‹è¯• (ç¬¬3-4å‘¨)
- [ ] å®ç°æ··åˆå¯åŠ¨æ¨¡å¼
- [ ] å®Œå–„ç»Ÿä¸€é…ç½®ç®¡ç†
- [ ] åˆ›å»ºå•å…ƒæµ‹è¯•å’ŒAPIæµ‹è¯•
- [ ] æ·»åŠ æ—¥å¿—å’Œç›‘æ§æœºåˆ¶
- [ ] å®Œå–„æ–‡æ¡£å’Œéƒ¨ç½²æŒ‡å—
- [ ] æ€§èƒ½ä¼˜åŒ–å’Œå‹åŠ›æµ‹è¯•

### Phase 4: ç”Ÿäº§å°±ç»ª (ç¬¬5å‘¨)
- [ ] æ·»åŠ å¥åº·æ£€æŸ¥å’Œç›‘æ§
- [ ] å®Œå–„é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶
- [ ] ä¼˜åŒ–å¹¶å‘æ€§èƒ½
- [ ] åˆ›å»ºéƒ¨ç½²å’Œè¿ç»´æ–‡æ¡£
- [ ] å®‰å…¨æ€§å®¡æŸ¥å’ŒåŠ å›º

## ğŸ”’ å®‰å…¨æ€§è€ƒè™‘

### 1. è®¤è¯å’Œæˆæƒ
- å¯é€‰çš„APIå¯†é’¥è®¤è¯
- ä¼šè¯éš”ç¦»å’Œç”¨æˆ·æƒé™æ§åˆ¶
- WebSocketè¿æ¥çš„èº«ä»½éªŒè¯

### 2. æ•°æ®å®‰å…¨
- æ•æ„Ÿé…ç½®ä¿¡æ¯çš„åŠ å¯†å­˜å‚¨
- æ•°æ®åº“è®¿é—®æƒé™æ§åˆ¶
- æ—¥å¿—ä¸­æ•æ„Ÿä¿¡æ¯çš„è„±æ•

### 3. ç½‘ç»œå®‰å…¨
- CORSé…ç½®å’Œè·¨åŸŸè®¿é—®æ§åˆ¶
- è¯·æ±‚é¢‘ç‡é™åˆ¶
- è¾“å…¥éªŒè¯å’ŒSQLæ³¨å…¥é˜²æŠ¤

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. å¹¶å‘å¤„ç†
- å¼‚æ­¥I/Oä¼˜åŒ–
- è¿æ¥æ± ç®¡ç†
- èµ„æºä½¿ç”¨ç›‘æ§

### 2. ç¼“å­˜ç­–ç•¥
- ä¼šè¯çŠ¶æ€ç¼“å­˜
- é…ç½®ä¿¡æ¯ç¼“å­˜
- å·¥å…·è°ƒç”¨ç»“æœç¼“å­˜

### 3. æ‰©å±•æ€§è®¾è®¡
- æ°´å¹³æ‰©å±•æ”¯æŒ
- è´Ÿè½½å‡è¡¡è€ƒè™‘
- å¾®æœåŠ¡æ¶æ„å‡†å¤‡

è¿™ä¸ªæ–¹æ¡ˆç¡®ä¿äº†ç°æœ‰åŠŸèƒ½çš„å®Œå…¨å…¼å®¹ï¼ŒåŒæ—¶ä¸ºWeb APIæ‰©å±•æä¾›äº†æ¸…æ™°çš„è·¯å¾„ï¼Œå¹¶è€ƒè™‘äº†ç”Ÿäº§ç¯å¢ƒçš„å„ç§éœ€æ±‚ã€‚
